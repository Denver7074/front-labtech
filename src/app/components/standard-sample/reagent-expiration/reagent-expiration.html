@if (info()) {
  <div class="year-selector">
    <mat-form-field appearance="outline">
      <mat-label>Год</mat-label>
      <mat-select [value]="selectedYear()" (selectionChange)="onYearChange($event)">
        @for (year of years(); track year) {
          <mat-option [value]="year">{{ year }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>

  <div class="attestation-grid-container mat-elevation-z1">
    <table mat-table [dataSource]="gridRows()" class="attestation-grid">

      <ng-container matColumnDef="name">
        <th mat-header-cell
            [matTooltip]="'Наименование, номер'"
            *matHeaderCellDef>
          Наименование, номер
        </th>
        <td mat-cell *matCellDef="let row" class="data-cell">
          {{ row.equipment.name }}, № {{ row.equipment.number }}
        </td>
      </ng-container>

      <ng-container matColumnDef="initialQuantity">
        <th mat-header-cell
            [matTooltip]="'Приход'"
            *matHeaderCellDef>
          Приход
        </th>
        <td mat-cell *matCellDef="let row" class="data-cell">
          {{ getValue(row.equipment.initialQuantity, row.equipment.unit) }}
        </td>
      </ng-container>

      <ng-container matColumnDef="remains">
        <th mat-header-cell
            [matTooltip]="'Остаток'"
            *matHeaderCellDef>
          Остаток
        </th>
        <td mat-cell *matCellDef="let row" class="data-cell">
          {{ getValue(row.equipment.remains, row.equipment.unit) }}
        </td>
      </ng-container>

      <!-- Месяцы -->
      @for (month of months; track month.key; let i = $index) {
        <ng-container [matColumnDef]="month.key">
          <th mat-header-cell *matHeaderCellDef>
            <div class="vertical-header">{{ month.name }}</div>
          </th>
          <td mat-cell *matCellDef="let row" class="mark-cell">
            @if (row.monthIndex === i) {
              {{ row.expiryDate | date:'shortDate' }}
            }
          </td>
        </ng-container>
      }

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
} @else {
  <p class="no-data">Нет данных</p>
}
